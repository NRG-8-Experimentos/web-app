<div class="analytics-member-container">
  <div class="member-card">
    <div class="avatar">
      <img *ngIf="member?.imgUrl; else defaultAvatar" [src]="member?.imgUrl" alt="Avatar" />
      <ng-template #defaultAvatar>
        <span class="default-avatar">&#128100;</span>
      </ng-template>
    </div>
    <div class="member-info">
      <div class="member-name">{{ member?.name }} {{ member?.surname }}</div>
      <div class="member-username">{{ member?.username }}</div>
      <div class="member-email">{{ member?.email }}</div>
    </div>
  </div>

  <div class="metrics-row">
    <div class="stat-card green">
      <div class="stat-value">{{ overview.completed }}</div>
      <div class="stat-label">Marcadas como Completadas</div>
    </div>
    <div class="stat-card teal">
      <div class="stat-value">{{ overview.done }}</div>
      <div class="stat-label">Terminadas</div>
    </div>
    <div class="stat-card blue">
      <div class="stat-value">{{ overview.inProgress }}</div>
      <div class="stat-label">En progreso</div>
    </div>
    <div class="stat-card orange">
      <div class="stat-value">{{ overview.pending }}</div>
      <div class="stat-label">Pendientes</div>
    </div>
    <div class="stat-card red">
      <div class="stat-value">{{ overview.overdue }}</div>
      <div class="stat-label">Atrasadas</div>
    </div>
  </div>

  <div class="section-card">
    <div class="section-title">
      <span class="material-icons">list_alt</span>
      Distribución de Tareas
    </div>
    <div *ngIf="loadingTasks" class="loading-tasks">
      <span class="material-icons spin">autorenew</span>
    </div>
    <div *ngIf="!loadingTasks && memberTasks.length === 0" class="no-tasks">
      No hay tareas asignadas.
    </div>
    <ul *ngIf="!loadingTasks && memberTasks.length > 0" class="tasks-list">
      <li *ngFor="let task of memberTasks; let i = index">
        <span class="task-index">{{ i + 1 }}.</span>
        <span class="task-title">{{ task.title }}</span>
      </li>
    </ul>
  </div>

  <div class="section-card">
    <div class="section-title">
      <span class="material-icons">build</span>
      Cantidad total de reprogramaciones
    </div>
    <div class="metric-row">
      <span>Reprogramadas</span>
      <span class="metric-value">{{ rescheduled.rescheduled }}</span>
    </div>
  </div>

  <div class="section-card">
    <div class="section-title">
      <span class="material-icons">date_range</span>
      Tiempo Promedio de Finalización
    </div>
    <div class="metric-row">
      <span class="material-icons">timer</span>
      <span class="metric-value">{{ formatAvgCompletionTime(avgCompletion.avgDays) }}</span>
    </div>
  </div>
</div>
